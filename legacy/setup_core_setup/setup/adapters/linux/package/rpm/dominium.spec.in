Name:           dominium
Version:        1.0.0
Release:        1%{?dist}
Summary:        Dominium (Setup Core managed)

License:        Proprietary
URL:            https://example.invalid/dominium

BuildArch:      x86_64

%description
Dominium is distributed with Setup Core state/plan handling.
Platform registrations are applied declaratively via dominium-setup-linux.

%post
DSU_BIN="${DSU_BIN:-/usr/bin/dominium-setup-linux}"
STATE_PATH="${STATE_PATH:-/var/lib/dominium/.dsu/installed_state.dsustate}"
"${DSU_BIN}" platform-register --state "${STATE_PATH}" --deterministic || exit $?

%preun
if [ "$1" -eq 0 ]; then
  DSU_BIN="${DSU_BIN:-/usr/bin/dominium-setup-linux}"
  STATE_PATH="${STATE_PATH:-/var/lib/dominium/.dsu/installed_state.dsustate}"
  "${DSU_BIN}" platform-unregister --state "${STATE_PATH}" --deterministic || exit $?
fi

%files
# Filled by packaging pipeline

